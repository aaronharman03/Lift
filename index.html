<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Task Tracker</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffffff" />
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 2rem auto; padding: 1rem; }
    h2 { margin-top: 2rem; }
    ul { list-style: none; padding-left: 0; }
    li { margin: 0.5rem 0; display: flex; align-items: center; justify-content: space-between; }
    label { flex: 1; cursor: pointer; }
    input[type="text"] {
      padding: 0.5rem;
      margin: 0.5rem 0;
      width: 70%;
      font-size: 16px; /* prevents zoom on mobile */
    }
    button {
      padding: 0.5rem;
      margin-left: 0.5rem;
      font-size: 16px;
    }
    form { display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
  </style>
</head>
<body>

<h1>Task Tracker</h1>

<div>
  <h2>Todayâ€™s Tasks</h2>
  <form id="today-form">
    <input type="text" id="today-input" placeholder="Add new Today task" />
    <button type="submit">Add</button>
  </form>
  <ul id="today-list"></ul>
</div>

<div>
  <h2>Future Tasks</h2>
  <form id="future-form">
    <input type="text" id="future-input" placeholder="Add new Future task" />
    <button type="submit">Add</button>
  </form>
  <ul id="future-list"></ul>
</div>

<script>
  const todayListEl = document.getElementById('today-list');
  const futureListEl = document.getElementById('future-list');
  const todayForm = document.getElementById('today-form');
  const futureForm = document.getElementById('future-form');
  const todayInput = document.getElementById('today-input');
  const futureInput = document.getElementById('future-input');

  let data = JSON.parse(localStorage.getItem('taskData')) || {
    today: [],
    future: []
  };

  function saveData() {
    localStorage.setItem('taskData', JSON.stringify(data));
  }

  function renderList(listEl, tasks, listName) {
    listEl.innerHTML = '';
    tasks.forEach((task, i) => {
      const li = document.createElement('li');
      const id = `${listName}-${i}`;
      li.innerHTML = `
        <label for="${id}">
          <input type="checkbox" id="${id}" ${task.done ? 'checked' : ''}>
          ${task.text}
        </label>
      `;

      const checkbox = li.querySelector('input');
      checkbox.addEventListener('change', () => {
        task.done = checkbox.checked;
        saveData();
      });

      const controls = document.createElement('div');

      if (listName === 'future') {
        const moveBtn = document.createElement('button');
        moveBtn.textContent = 'â†’ Today';
        moveBtn.addEventListener('click', () => {
          data.today.push({ ...task, done: false });
          data[listName].splice(i, 1);
          saveData();
          renderAll();
        });
        controls.appendChild(moveBtn);
      }

      const delBtn = document.createElement('button');
      delBtn.textContent = 'ðŸ—‘';
      delBtn.addEventListener('click', () => {
        data[listName].splice(i, 1);
        saveData();
        renderAll();
      });

      controls.appendChild(delBtn);
      li.appendChild(controls);
      listEl.appendChild(li);
    });
  }

  function renderAll() {
    renderList(todayListEl, data.today, 'today');
    renderList(futureListEl, data.future, 'future');
  }

  todayForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const val = todayInput.value.trim();
    if (val) {
      data.today.push({ text: val, done: false });
      todayInput.value = '';
      saveData();
      renderAll();
    }
  });

  futureForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const val = futureInput.value.trim();
    if (val) {
      data.future.push({ text: val, done: false });
      futureInput.value = '';
      saveData();
      renderAll();
    }
  });

  renderAll();

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').then(() => {
      console.log('Service Worker registered');
    }).catch(console.error);
  }
</script>

</body>
</html>
