<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Workout Tracker - Minimal</title>
  <style>
    body {
      max-width: 700px;
      margin: 20px auto;
      font-family: system-ui, sans-serif;
      background: #f9f9f9;
      color: #222;
    }
    h1 {
      text-align: center;
      margin-bottom: 1rem;
    }
    form {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
    }
    input[type="text"],
    input[type="date"],
    input[type="number"] {
      padding: 6px 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      width: 100%;
      box-sizing: border-box;
      margin-bottom: 10px;
    }
    button {
      background: #2a7fff;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease;
      margin-top: 5px;
    }
    button:hover {
      background: #155ec9;
    }
    .exercise {
      background: #eee;
      padding: 10px 12px;
      border-radius: 8px;
      margin-bottom: 12px;
      position: relative;
    }
    .exercise-header {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .exercise-header > * {
      flex: 1 1 150px;
      min-width: 120px;
    }
    .sets-row {
      display: flex;
      gap: 6px;
      margin-top: 8px;
      flex-wrap: wrap;
    }
    .sets-row input {
      width: 60px;
      padding: 6px 8px;
      font-size: 1rem;
      border: 1px solid #bbb;
      border-radius: 6px;
      text-align: center;
    }
    .add-set-btn,
    .remove-exercise-btn {
      margin-top: 8px;
      background: #444;
      padding: 6px 12px;
      font-size: 0.9rem;
    }
    .remove-exercise-btn {
      background: #cc4444;
      margin-left: 10px;
    }
    .workout-list {
      margin-top: 30px;
    }
    .workout-item {
      background: white;
      padding: 14px 18px;
      border-radius: 10px;
      box-shadow: 0 1px 5px rgb(0 0 0 / 0.1);
      margin-bottom: 16px;
    }
    .workout-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      margin-bottom: 10px;
      font-size: 1.1rem;
    }
    .exercises-list {
      margin-left: 10px;
    }
    .exercise-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 4px;
      border-bottom: 1px solid #eee;
      font-size: 1rem;
      user-select: none;
    }
    .exercise-line:last-child {
      border-bottom: none;
    }
    .exercise-text {
      flex-grow: 1;
    }
    /* 3-dot menu */
    .menu {
      position: relative;
      font-weight: 700;
      font-size: 22px;
      line-height: 1;
      padding: 0 6px;
      cursor: pointer;
      user-select: none;
    }
    .menu-items {
      display: none;
      position: absolute;
      right: 0;
      top: 26px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: 0 4px 8px rgb(0 0 0 / 0.1);
      z-index: 10;
      min-width: 110px;
    }
    .menu-items button {
      display: block;
      padding: 8px 12px;
      width: 100%;
      border: none;
      background: none;
      text-align: left;
      cursor: pointer;
      font-size: 0.95rem;
      color: #333;
    }
    .menu-items button:hover {
      background: #2a7fff;
      color: white;
    }
    .delete-workout-btn {
      background: #cc4444;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      font-size: 0.9rem;
      user-select: none;
    }
    .delete-workout-btn:hover {
      background: #a23333;
    }
  </style>
</head>
<body>
  <h1>Workout Tracker</h1>

  <form id="workoutForm">
    <label for="workoutDate">Date:</label>
    <input type="date" id="workoutDate" required />

    <label for="workoutType">Workout Type (e.g. Chest, Legs):</label>
    <input type="text" id="workoutType" placeholder="Workout Type" required />

    <div id="exercisesContainer"></div>

    <button type="button" id="addExerciseBtn">+ Add Exercise</button>

    <button type="submit" style="margin-left: 10px;">Save Workout</button>
  </form>

  <div class="workout-list" id="workoutList"></div>

<script>
  const STORAGE_KEY = "workoutsMinimal";

  const workoutForm = document.getElementById("workoutForm");
  const exercisesContainer = document.getElementById("exercisesContainer");
  const addExerciseBtn = document.getElementById("addExerciseBtn");
  const workoutList = document.getElementById("workoutList");
  const workoutDateInput = document.getElementById("workoutDate");
  const workoutTypeInput = document.getElementById("workoutType");

  let workouts = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

  // Create exercise block with separated reps inputs
  function createExerciseBlock() {
    const exerciseDiv = document.createElement("div");
    exerciseDiv.className = "exercise";

    exerciseDiv.innerHTML = `
      <div class="exercise-header">
        <input type="text" placeholder="Exercise Name" class="exercise-name" required />
        <input type="number" min="0" step="0.1" placeholder="Weight" class="exercise-weight" required />
      </div>
      <div class="sets-row">
        <input type="number" min="1" step="1" placeholder="Reps" class="set-rep" required />
      </div>
      <button type="button" class="add-set-btn">+ Add Set</button>
      <button type="button" class="remove-exercise-btn">Remove Exercise</button>
    `;

    const addSetBtn = exerciseDiv.querySelector(".add-set-btn");
    const removeExerciseBtn = exerciseDiv.querySelector(".remove-exercise-btn");
    const setsRow = exerciseDiv.querySelector(".sets-row");

    addSetBtn.addEventListener("click", () => {
      const newRepInput = document.createElement("input");
      newRepInput.type = "number";
      newRepInput.min = 1;
      newRepInput.step = 1;
      newRepInput.placeholder = "Reps";
      newRepInput.className = "set-rep";
      newRepInput.required = true;
      setsRow.appendChild(newRepInput);
    });

    removeExerciseBtn.addEventListener("click", () => {
      exerciseDiv.remove();
    });

    return exerciseDiv;
  }

  // Render all workouts list
  function renderWorkouts() {
    workoutList.innerHTML = "";

    if (workouts.length === 0) {
      workoutList.innerHTML = "<p>No workouts logged yet.</p>";
      return;
    }

    workouts.forEach((workout, wIndex) => {
      const workoutDiv = document.createElement("div");
      workoutDiv.className = "workout-item";

      const headerDiv = document.createElement("div");
      headerDiv.className = "workout-header";

      const dateSpan = document.createElement("div");
      dateSpan.textContent = new Date(workout.date).toLocaleDateString();

      const typeSpan = document.createElement("div");
      typeSpan.textContent = workout.workoutType;

      // Delete entire workout button
      const deleteWorkoutBtn = document.createElement("button");
      deleteWorkoutBtn.textContent = "Delete Workout";
      deleteWorkoutBtn.className = "delete-workout-btn";
      deleteWorkoutBtn.addEventListener("click", () => {
        if (confirm("Delete this entire workout?")) {
          workouts.splice(wIndex, 1);
          saveAndRender();
        }
      });

      headerDiv.appendChild(dateSpan);
      headerDiv.appendChild(typeSpan);
      headerDiv.appendChild(deleteWorkoutBtn);

      workoutDiv.appendChild(headerDiv);

      const exercisesListDiv = document.createElement("div");
      exercisesListDiv.className = "exercises-list";

      workout.exercises.forEach((ex, eIndex) => {
        const exerciseLine = document.createElement("div");
        exerciseLine.className = "exercise-line";

        const exerciseText = document.createElement("div");
        exerciseText.className = "exercise-text";
        // Format sets as: name - weight - rep1, rep2, rep3
        exerciseText.textContent = `${ex.name} - ${ex.weight} - ${ex.sets.join(", ")}`;

        const menuDiv = document.createElement("div");
        menuDiv.className = "menu";
        menuDiv.textContent = "â‹®";

        const menuItemsDiv = document.createElement("div");
        menuItemsDiv.className = "menu-items";

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Delete Exercise";
        deleteBtn.addEventListener("click", () => {
          if (confirm("Delete this exercise?")) {
            workout.exercises.splice(eIndex, 1);
            // If no exercises left, delete workout
            if (workout.exercises.length === 0) {
              workouts.splice(wIndex, 1);
            }
            saveAndRender();
          }
        });

        menuItemsDiv.appendChild(deleteBtn);
        menuDiv.appendChild(menuItemsDiv);

        menuDiv.addEventListener("click", (e) => {
          e.stopPropagation();
          // close all other menus first
          document.querySelectorAll(".menu-items").forEach(m => {
            if (m !== menuItemsDiv) m.style.display = "none";
          });
          menuItemsDiv.style.display = menuItemsDiv.style.display === "block" ? "none" : "block";
        });

        exerciseLine.appendChild(exerciseText);
        exerciseLine.appendChild(menuDiv);

        exercisesListDiv.appendChild(exerciseLine);
      });

      workoutDiv.appendChild(exercisesListDiv);

      workoutList.appendChild(workoutDiv);
    });
  }

  // Save and rerender helper
  function saveAndRender() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(workouts));
    renderWorkouts();
  }

  // Add new exercise button handler
  addExerciseBtn.addEventListener("click", () => {
    exercisesContainer.appendChild(createExerciseBlock());
  });

  // Handle workout form submission
  workoutForm.addEventListener("submit", (e) => {
    e.preventDefault();

    const date = workoutDateInput.value;
    const workoutType = workoutTypeInput.value.trim();

    if (!date) {
      alert("Please select a date");
      return;
    }
    if (!workoutType) {
      alert("Please enter workout type");
      return;
    }

    const exerciseDivs = exercisesContainer.querySelectorAll(".exercise");
    if (exerciseDivs.length === 0) {
      alert("Please add at least one exercise");
      return;
    }

    const exercises = [];

    for (const exerciseDiv of exerciseDivs) {
      const nameInput = exerciseDiv.querySelector(".exercise-name");
      const weightInput = exerciseDiv.querySelector(".exercise-weight");
      const repsInputs = exerciseDiv.querySelectorAll(".set-rep");

      const name = nameInput.value.trim();
      const weight = parseFloat(weightInput.value);

      if (!name) {
        alert("Exercise name cannot be empty");
        return;
      }
      if (isNaN(weight) || weight <= 0) {
        alert("Please enter valid weight");
        return;
      }

      const reps = [];
      for (const rInput of repsInputs) {
        const val = parseInt(rInput.value);
        if (isNaN(val) || val <= 0) {
          alert("Please enter valid reps");
          return;
        }
        reps.push(val);
      }
      if (reps.length === 0) {
        alert("Please add at least one rep set");
        return;
      }

      exercises.push({ name, weight, sets: reps });
    }

    workouts.unshift({ date, workoutType, exercises });

    saveAndRender();

    workoutForm.reset();
    exercisesContainer.innerHTML = "";
    exercisesContainer.appendChild(createExerciseBlock());
  });

  // Close menus if clicking outside
  window.addEventListener("click", () => {
    document.querySelectorAll(".menu-items").forEach(m => (m.style.display = "none"));
  });

  // Initial setup: add one exercise block on load
  exercisesContainer.appendChild(createExerciseBlock());
  renderWorkouts();
</script>

</body>
</html>





