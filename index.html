<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Workout Days</title>
<style>
  body {
    font-family: sans-serif;
    max-width: 500px;
    margin: 40px auto;
    padding: 0 16px;
    background: #f9f9f9;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
  }
  .day-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: white;
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 12px 14px;
    margin-bottom: 12px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    position: relative;
  }
  .day-label {
    font-size: 16px;
    flex-grow: 1;
    text-decoration: none;
    color: black;
    word-break: break-word;
  }
  .day-label[contenteditable="true"] {
    background: #eef5ff;
    outline: none;
    padding: 2px 4px;
    border-radius: 4px;
  }
  .menu-btn {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    padding: 4px;
    margin-left: 8px;
  }
  .menu {
    position: absolute;
    background: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    padding: 4px 0;
    z-index: 10;
    min-width: 120px;
  }
  .menu button {
    display: block;
    width: 100%;
    padding: 8px 10px;
    background: none;
    border: none;
    text-align: left;
    font-size: 14px;
    cursor: pointer;
  }
  .menu button:hover {
    background: #f0f0f0;
  }
  #addDayBtn {
    display: block;
    width: 100%;
    margin-top: 20px;
    padding: 12px;
    font-size: 16px;
    border-radius: 8px;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
  }
  #addDayBtn:hover {
    background-color: #0056b3;
  }
</style>
</head>
<body>
<h1>Workout Days</h1>
<div id="daysList"></div>
<button id="addDayBtn">+ Add Day</button>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
  // Your Firebase config — replace these with your real values
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    databaseURL: "YOUR_DATABASE_URL",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // Temporary user ID for demo/testing
  const userId = 'defaultUser';

  const daysList = document.getElementById('daysList');
  const addDayBtn = document.getElementById('addDayBtn');

  // Workout days array — will load from Firebase or start empty
  let days = [];

  // Load days from Firebase on page load
  function loadDays() {
    firebase.database().ref(`users/${userId}/workoutDays`).once('value').then(snapshot => {
      const data = snapshot.val();
      if (data) {
        days = data;
      } else {
        days = [];
      }
      renderDays();
    });
  }

  // Save days to Firebase
  function saveDays() {
    firebase.database().ref(`users/${userId}/workoutDays`).set(days);
  }

  // Render the days list in the UI
  function renderDays() {
    daysList.innerHTML = '';
    days.forEach((day, index) => {
      const row = document.createElement('div');
      row.className = 'day-row';

      const label = document.createElement('a');
      label.className = 'day-label';
      label.textContent = day.name;
      label.href = `day.html?day=${day.id}`;

      // Menu button
      const menuBtn = document.createElement('button');
      menuBtn.className = 'menu-btn';
      menuBtn.textContent = '⋮';

      // Menu container
      const menu = document.createElement('div');
      menu.className = 'menu';
      menu.style.display = 'none';

      // Rename button
      const renameBtn = document.createElement('button');
      renameBtn.textContent = 'Rename';
      renameBtn.onclick = () => {
        label.contentEditable = true;
        label.focus();
        closeMenu();
      };

      // Delete button
      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => {
        if (confirm(`Delete "${day.name}"?`)) {
          days.splice(index, 1);
          saveDays();
          renderDays();
        }
      };

      menu.appendChild(renameBtn);
      menu.appendChild(deleteBtn);

      // Append menu to the row (position: absolute inside row)
      row.appendChild(menu);

      // Show/hide menu on button click
      menuBtn.onclick = (e) => {
        e.stopPropagation();
        toggleMenu(menu, menuBtn);
      };

      // Handle label editing finish
      label.addEventListener('blur', () => {
        if (!label.isContentEditable) return;
        label.contentEditable = false;
        const newName = label.textContent.trim();
        if (newName) {
          day.name = newName;
          saveDays();
        } else {
          label.textContent = day.name; // revert if empty
        }
      });

      label.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          e.preventDefault();
          label.blur();
        }
      });

      row.appendChild(label);
      row.appendChild(menuBtn);
      daysList.appendChild(row);
    });
  }

  let openMenu = null;

  // Show the context menu positioned under the button
  function toggleMenu(menu, btn) {
    if (openMenu && openMenu !== menu) {
      openMenu.style.display = 'none';
    }
    if (menu.style.display === 'block') {
      menu.style.display = 'none';
      openMenu = null;
      return;
    }
    const rect = btn.getBoundingClientRect();
    const scrollY = window.scrollY || document.documentElement.scrollTop;
    const scrollX = window.scrollX || document.documentElement.scrollLeft;
    menu.style.top = (rect.bottom + scrollY + 4) + 'px';
    menu.style.left = (Math.min(rect.left + scrollX, window.innerWidth - 140)) + 'px';
    menu.style.display = 'block';
    openMenu = menu;
  }

  // Close any open menu
  function closeMenu() {
    if (openMenu) openMenu.style.display = 'none';
    openMenu = null;
  }

  // Add new day button click
  addDayBtn.onclick = () => {
    const nextId = days.length ? Math.max(...days.map(d => d.id)) + 1 : 1;
    days.push({ id: nextId, name: `Day ${nextId}` });
    saveDays();
    renderDays();
  };

  // Close menu when clicking outside
  window.addEventListener('click', closeMenu);

  // Initial load
  loadDays();
</script>

</body>
</html>


